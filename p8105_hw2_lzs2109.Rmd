---
title: "Data Science I Homework 2 - lzs2109"
author: "Louis Sharp"
date: "10/01/2021"
output: github_document
---

### **Problem 1**

```{r, message = FALSE}
library(tidyverse)
library(readxl)
```

```{r}
mtw_df = read_excel("data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", 
                    sheet = "Mr. Trash Wheel",
                    range = "A2:N408") %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(sports_balls = as.integer(sports_balls))

precip18_df = read_excel("data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", 
                    sheet = "2018 Precipitation",
                    range = "A2:B14") %>% 
  mutate(year = 2018)

precip19_df = read_excel("data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", 
                    sheet = "2019 Precipitation",
                    range = "A2:B14") %>% 
  mutate(year = 2019)

precip_df = bind_rows(precip18_df, precip19_df) %>% 
  janitor::clean_names() %>% 
  mutate(month = month.name[month]) %>% 
  relocate(month, year)
```

The Mr. Trash Wheel and precipitation data sets both come from the same excel file about Baltimore's Mr. Trash Wheel, a device that collects trash from Jones Falls river as it enters Baltimore's Inner Harbor. The trash is then incinerated to provide power to the Baltimore area. The Trash Wheel data set includes temporal details, info on the mass of trash collected, and type of trash collected by the device per dumpster filled, in addition to estimates of power generated as a result. The variables included in the dataset are `r names(mtw_df)`, and includes info on `r nrow(mtw_df)` different dumpsters filled with trash collected by the device, each denoted by a different row. For example, Mr. Trash Wheel collected a median of 
`r median(pull(filter(mtw_df, year == 2017), sports_balls))` sports balls in 2017.
The precipitation data set includes information about how much rain was measured per month for the years 2018 and 2019. This is important because the Mr. Trash Wheel website indicates that the level of precipitation influences the amount and type of trash the device collects. Variables in the precipitation dataset include `r names(precip_df)`, and there is data for all twelve months in 2018 and up to June of 2019. For example, in 2018 there was a total of 
`r sum(pull(precip18_df, Total))` inches of rain for the year.


### **Problem 2**

```{r}
pols_df = read_csv("data/fivethirtyeight_datasets/pols-month.csv") %>% 
  separate(mon, into = c("year", "month", "day")) %>% 
  mutate(month = as.numeric(month), 
         month = month.name[month],
         year = as.numeric(year))

gop_or_dem = pull(pols_df, prez_dem)
gop_or_dem = ifelse(gop_or_dem == 1, "dem", "gop") 

pols_df = mutate(pols_df, president = gop_or_dem) %>% 
  select(-prez_dem, -prez_gop, -day)
  
snp_df = read_csv("data/fivethirtyeight_datasets/snp.csv") %>% 
  separate(date, into = c("month", "day", "year")) %>% 
  mutate(month = as.numeric(month), 
         month = month.name[month],
         year = as.numeric(year)) %>% 
  select(-day) %>% 
  relocate(year, month)
```

```{r}
unemp_df = read_excel("data/fivethirtyeight_datasets/unemployment.xlsx")

unemp_tidy_df = pivot_longer(
  unemp_df,
  Jan:Dec,
  names_to = "month",
  values_to = "percent_unemployed") %>% 
  janitor::clean_names()

unemp_tidy_months = pull(unemp_tidy_df, month)
length(unemp_tidy_months)/12
month_nums = rep(1:12, 68)

unemp_tidy_df = mutate(unemp_tidy_df,
                       month_nums = month_nums,
                       month_nums = month.name[month_nums])

#scroll through the data frame to make sure the full name months match the abbreviated ones
#it looks like they do, so replace the column month with month_nums's values

unemp_tidy_df = mutate(unemp_tidy_df, month = month_nums) %>% 
  select(-month_nums)
```

That's kind of a big code chunk above, so I'm going to make a new one for the merges.
First, we have to convert years in snp_df from 2 digits to 4 digits.

```{r}
snp_df_yrs_vec = pull(snp_df, year)
snp_df_yrs_vec = ifelse(snp_df_yrs_vec > 40, 
                        snp_df_yrs_vec + 1900, snp_df_yrs_vec + 2000)
snp_df = mutate(snp_df, year = snp_df_yrs_vec) #change snp_df years to 4 digits
```

```{r}
pols_snp_df = left_join(pols_df, snp_df, by = c("year", "month")) 
#merge pol_df and snap_df by year and month keys
pols_snp_unemp_df = left_join(pols_snp_df, unemp_tidy_df, by = c("year", "month"))
#merging unemp_tidy_df with same keys
```

These three dataset contain information and data surrounding politics and history in the United States. The pols dataframe contains info on the number of senators, governors, and representatives from `r min(pull(pols_df, year))` to `r max(pull(pols_df, year))` grouped by their political affiliation, republican or democrat. It also included political affiliation of the president until we merged the dem and gop columns into one president column (for which there are two during Aug-Dec 1974, presumably when Nixon was impeached and Ford took office). The snp dataframe contains data on the closing numbers of the S&P stock market index for every month between `r min(pull(snp_df, year))` to `r max(pull(snp_df, year))`, as a general measure of the state of the economy during those times. Finally, the unemployment dataframe includes the percentage of unemployment in the U.S. for months between the years `r min(pull(unemp_tidy_df, year))` to `r max(pull(unemp_tidy_df, year))`. Since these three datasets incorporate which political party held more power during any given month/year, the state of the economy by a general measure, and the percent of unemployed, it seemed interesting to merge them and compare how political party's power may have affected the economy and unemployment rates. The resulting dataframe incorporates 
`r nrow(pols_snp_unemp_df)` observations for the variables `r names(pols_snp_unemp_df)` between the years `r min(pull(pols_snp_unemp_df, year))` to `r max(pull(pols_snp_unemp_df, year))`.


### **Problem 3**

```{r}
bby_names = read_csv("data/Popular_Baby_Names.csv") %>% 
  janitor::clean_names()
```

```{r, eval = FALSE}
ethnicities = pull(bby_names, ethnicity)
table(ethnicities) #used to see easily which ethnic group names needed changing
```

```{r}
bby_names = mutate(bby_names, 
                   ethnicity = str_replace(ethnicity, 
                                           "ASIAN AND PACIFIC ISLANDER", "ASIAN AND PACI"),
                   ethnicity = str_replace(ethnicity,
                                           "BLACK NON HISPANIC", "BLACK NON HISP"),
                   ethnicity = str_replace(ethnicity,
                                           "WHITE NON HISPANIC", "WHITE NON HISP"),
                   childs_first_name = str_to_title(childs_first_name))
                   
```

```{r}
#ethnicities = pull(bby_names, ethnicity)
#table(ethnicities)
#first_name = pull(bby_names, childs_first_name)
#table(first_name) #code chunk used to evalutate if above chunk worked properly
```

```{r}
#bby_names = distinct(bby_names)
```

